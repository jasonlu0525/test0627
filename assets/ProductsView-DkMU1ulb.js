import{a as P,m as C,e as k,_ as T,o as n,c as a,b as e,f as m,g as f,F as y,h as U,t as r,n as S,w as $,v as V,d as c,i as q,j as g,r as h,k as x,L as A,l as w}from"./index-as_EUU8_.js";import{c as v}from"./cartStore-BNIuY5bG.js";var I={BASE_URL:"/test0627/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Q,VITE_PATH:D}=I,R={data(){return{userModal:null,editCarts:{},status:{checkProduct:""},form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{sendOrder(){this.isLoading=!0;let t=`${Q}/api/${D}/order`;const l=this.form;P.post(t,{data:l}).then(u=>{this.$refs.form.resetForm(),this.isLoading=!1,u.data.success&&this.getCarts()})},isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"電話為必填，須為有效的電話號碼"},...C(v,["getCarts","addToCart","cartChangeQty","delCartItem","delAllCart"])},watch:{},mounted(){},computed:{...k(v,["carts","cartslength","addCartLoading","cartQtyLoading","delCart"])}},M={class:"text-end"},B=["disabled"],N={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},O={class:"table align-middle"},j=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"170px"}},"數量/單位"),e("th",{style:{width:"120px"}}),e("th",null,"單價"),e("th",null,"小計")])],-1),z=["onClick","disabled"],F={key:0,class:"bi bi-x-lg"},H={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},G={class:"input-group input-group-sm"},J={class:"input-group mb-3"},K=["disabled","onClick"],W=["onUpdate:modelValue","disabled"],X=["onClick","disabled"],Y={class:"input-group-text",id:"basic-addon2"},Z=e("td",null,null,-1),ee={class:"text-end"},se={key:0},te=e("small",{class:"text-success"},"折扣價：",-1),oe={key:1},le={key:0,class:"text-end"},ne={key:1,class:"text-end"},ae=e("td",{colspan:"5",class:"text-end"},"總計",-1),de={class:"text-end"},ie={key:0},re=e("td",{colspan:"5",class:"text-end text-success"},"折扣價",-1),ce={class:"text-end text-success"},ue={class:"my-5 row justify-content-center"},pe={class:"mb-3"},_e=e("label",{for:"email",class:"form-label"},"Email",-1),me={class:"mb-3"},he=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),be={class:"mb-3"},ge=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),fe={class:"mb-3"},ye=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ve={class:"mb-3"},Ce=e("label",{for:"message",class:"form-label"},"留言",-1),ke={class:"text-end"},$e=["disabled"];function Ve(t,l,u,E,d,b){const p=h("v-field"),_=h("error-message"),o=h("v-form");return n(),a(y,null,[e("div",M,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:l[0]||(l[0]=(...s)=>t.delAllCart&&t.delAllCart(...s)),disabled:t.delCart==="delAll"},[t.delCart==="delAll"?(n(),a("span",N)):m("",!0),f(" 清空購物車 ")],8,B)]),e("table",O,[j,e("tbody",null,[(n(!0),a(y,null,U(t.carts.carts,s=>(n(),a("tr",{key:s.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:i=>t.delCartItem(s.id),disabled:s.id===t.delCart},[s.id!==t.delCart?(n(),a("i",F)):m("",!0),s.id===t.delCart?(n(),a("span",H)):m("",!0)],8,z)]),e("td",null,r(s.product.title),1),e("td",null,[e("div",G,[e("div",J,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",style:S(s.qty===1?"display:none;":""),disabled:s.qty===1||s.id===t.cartQtyLoading,onClick:i=>(s.qty--,t.cartChangeQty(s,s.qty))}," - ",12,K),$(e("input",{min:"1",type:"number",class:"form-control",style:{"text-align":"center"},"onUpdate:modelValue":i=>s.qty=i,disabled:s.id===t.cartQtyLoading,readonly:""},null,8,W),[[V,s.qty]]),e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:i=>(s.qty++,t.cartChangeQty(s,s.qty)),disabled:s.id===t.cartQtyLoading}," + ",8,X),e("span",Y,r(s.product.unit),1)])])]),Z,e("td",ee,[s.product.price<s.product.origin_price?(n(),a("div",se,[te,e("del",null,r(s.product.origin_price),1),f(" "+r(s.product.price),1)])):(n(),a("div",oe,r(s.product.origin_price),1))]),s.product.price<s.product.origin_price?(n(),a("td",le,r(s.product.price*s.qty),1)):(n(),a("td",ne,r(s.product.origin_price*s.qty),1))]))),128))]),e("tfoot",null,[e("tr",null,[ae,e("td",de,r(t.carts.total),1)]),t.carts.final_total<t.carts.total?(n(),a("tr",ie,[re,e("td",ce,r(t.carts.final_total),1)])):m("",!0)])]),e("div",ue,[c(o,{ref:"form",class:"col-md-6",onSubmit:b.sendOrder},{default:q(({errors:s})=>[e("div",pe,[_e,c(p,{id:"email",name:"email",type:"email",class:g(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:d.form.user.email,"onUpdate:modelValue":l[1]||(l[1]=i=>d.form.user.email=i)},null,8,["class","modelValue"]),c(_,{name:"email",class:"invalid-feedback"})]),e("div",me,[he,c(p,{id:"name",name:"姓名",type:"text",class:g(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:d.form.user.name,"onUpdate:modelValue":l[2]||(l[2]=i=>d.form.user.name=i)},null,8,["class","modelValue"]),c(_,{name:"姓名",class:"invalid-feedback"})]),e("div",be,[ge,c(p,{id:"tel",name:"電話",type:"text",class:g(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:b.isPhone,modelValue:d.form.user.tel,"onUpdate:modelValue":l[3]||(l[3]=i=>d.form.user.tel=i)},null,8,["class","rules","modelValue"]),c(_,{name:"電話",class:"invalid-feedback"})]),e("div",fe,[ye,c(p,{id:"address",name:"地址",type:"text",class:g(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:d.form.user.address,"onUpdate:modelValue":l[4]||(l[4]=i=>d.form.user.address=i)},null,8,["class","modelValue"]),c(_,{name:"地址",class:"invalid-feedback"})]),e("div",ve,[Ce,$(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":l[5]||(l[5]=i=>d.form.message=i)},null,512),[[V,d.form.message]])]),e("div",ke,[e("button",{type:"submit",class:"btn btn-danger",disabled:d.form.user.id===t.cartQtyLoading}," 送出訂單 ",8,$e)])]),_:1},8,["onSubmit"])])],64)}const Le=T(R,[["render",Ve]]);var Pe={BASE_URL:"/test0627/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Te,VITE_PATH:Ue}=Pe,L=x("productStore",{stste:()=>({products:[],pages:{}}),actions:{getProducts(t=1){let l=`${Te}/api/${Ue}/products?page=${t}`;P.get(l).then(u=>{this.products=u.data.products,this.pages=u.data.pagination,console.log("pages",this.pages)}).catch(u=>{console.log("err",u),this.products=[],this.pages={}})}}}),Ee={data(){return{tempProduct:{},selectID:"",status:{checkProduct:""},isActive:"all",isLoading:!1,form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{openModal(t){this.$refs.uModal.openModal(),this.status.checkProduct=t.id,this.tempProduct={...t},setTimeout(()=>{this.status.checkProduct=""},200)},...C(L,["getProducts"]),...C(v,["getCarts","addToCart","cartChangeQty","delCartItem","delAllCart"])},created(){},mounted(){this.isLoading=!0,this.getProducts(),this.getCarts(),setTimeout(()=>{this.isLoading=!1},1e3)},components:{Loading:A,UserCart:Le},computed:{...k(L,["products","pages"]),...k(v,["carts","cartslength","addCartLoading","cartQtyLoading","setIsLoading","delCart"])}},Se={class:"container"},qe={class:"mt-4"},xe=e("h2",{class:"d-flex justify-content-center",style:{"margin-top":"75px"}},"商品列表",-1),Ae={class:"row d-flex list-unstyled"},we={class:"img-fluid hovereffect px-3",style:{"background-size":"cover","background-position":"center",width:"100%",height:"250px"}},Ie=["src","alt","title"],Qe={class:"overlay",style:{"margin-top":"100px"}},De=["disabled","onClick"],Re={class:"py-1",style:{"text-align":"center"}},Me={class:"products-title m-0",role:"button"},Be={key:0,class:"products-title mt-1",role:"button"},Ne={class:"small"},Oe={class:"small",style:{color:"red"}},je={key:1,class:"products-title mt-1",role:"button"},ze={class:"small"},Fe=["disabled","onClick"],He=e("i",{class:"fas fa-spinner fa-pulse"},null,-1),Ge={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function Je(t,l,u,E,d,b){const p=h("Loading"),_=h("UserCart");return n(),a(y,null,[c(p,{active:d.isLoading},null,8,["active"]),e("div",Se,[e("div",qe,[xe,e("ul",Ae,[(n(!0),a(y,null,U(t.products,o=>(n(),a("li",{class:"col-lg-4 col-md-8",key:o.id},[e("div",we,[e("img",{class:"img-responsive",style:{width:"100%",height:"100%"},src:o.imageUrl,alt:o.title,title:o.title+":"+o.description},null,8,Ie),e("div",Qe,[e("h2",null,r(o.title),1),e("a",{href:"#",type:"button",class:"info",disabled:o.id===d.status.checkProduct,onClick:s=>b.openModal(o)}," 查看更多 ",8,De)])]),e("div",Re,[e("p",Me,r(o.title),1),o.price<o.origin_price?(n(),a("p",Be,[e("del",Ne,"$ "+r(o.origin_price),1),f(" 現在只要  "),e("span",Oe,"$ "+r(o.price),1)])):(n(),a("p",je,[e("span",ze,"$ "+r(o.origin_price),1)])),e("button",{type:"button",class:"btn btn-outline-secondary btn-sm mx-auto fs-6",disabled:o.id===t.addCartLoading,onClick:s=>t.addToCart(o.id,1)},[He,o.id===t.addCartLoading?(n(),a("span",Ge)):m("",!0),f(" 加入購物車 ")],8,Fe)])]))),128))]),t.cartslength>0?(n(),w(_,{key:0})):m("",!0)])])],64)}const Xe=T(Ee,[["render",Je]]);export{Xe as default};
